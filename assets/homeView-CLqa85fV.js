import{o as V,n as D,g as R,a as j,b as O,w as q,s as P,r as I,c as L,t as x,u as S,_ as F,d as W,e as A,f as b,h as c,i as d,j as _,k as M,l as y,m as v,F as K,p as H,q as J,V as N,v as Q}from"./index-0638g7QK.js";import{u as X}from"./list-BXiajhXS.js";import{u as Y}from"./settings-DwE2RriS.js";import{V as Z,a as B,b as ee}from"./VDivider-BYG01Pyv.js";function G(e,t){return R()?(j(e,t),!0):!1}function k(){const e=new Set,t=i=>{e.delete(i)};return{on:i=>{e.add(i);const o=()=>t(i);return G(o),{off:o}},off:t,trigger:(...i)=>Promise.all(Array.from(e).map(o=>o(...i))),clear:()=>{e.clear()}}}const te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ne=Object.prototype.toString,ie=e=>ne.call(e)==="[object Object]";function E(e){return Array.isArray(e)?e:[e]}function oe(e){return O()}function se(e,t=!0,r){oe()?V(e,r):t?e():D(e)}function re(e,t,r){return q(e,t,{...r,immediate:!0})}const U=te?window:void 0;function ae(e){var t;const r=x(e);return(t=r?.$el)!==null&&t!==void 0?t:r}function ce(...e){const t=(n,s,i,o)=>(n.addEventListener(s,i,o),()=>n.removeEventListener(s,i,o)),r=L(()=>{const n=E(x(e[0])).filter(s=>s!=null);return n.every(s=>typeof s!="string")?n:void 0});return re(()=>{var n,s;return[(n=(s=r.value)===null||s===void 0?void 0:s.map(i=>ae(i)))!==null&&n!==void 0?n:[U].filter(i=>i!=null),E(x(r.value?e[1]:e[0])),E(S(r.value?e[2]:e[1])),x(r.value?e[3]:e[2])]},([n,s,i,o],f,p)=>{if(!n?.length||!s?.length||!i?.length)return;const g=ie(o)?{...o}:o,h=n.flatMap(a=>s.flatMap(l=>i.map(m=>t(a,l,m,g))));p(()=>{h.forEach(a=>a())})},{flush:"post"})}function le(){const e=P(!1),t=O();return t&&V(()=>{e.value=!0},t),e}function ue(e){const t=le();return L(()=>(t.value,!!e()))}function de(e={}){const{window:t=U,requestPermissions:r=!0}=e,n=e,s=ue(()=>{if(!t||!("Notification"in t))return!1;if(Notification.permission==="granted")return!0;try{const u=new Notification("");u.onshow=()=>{u.close()}}catch(u){if(u.name==="TypeError")return!1}return!0}),i=P(s.value&&"permission"in Notification&&Notification.permission==="granted"),o=I(null),f=async()=>{if(s.value)return!i.value&&Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&(i.value=!0),i.value},{on:p,trigger:g}=k(),{on:h,trigger:a}=k(),{on:l,trigger:m}=k(),{on:T,trigger:$}=k(),z=async u=>{if(!s.value||!i.value)return;const w=Object.assign({},n,u);return o.value=new Notification(w.title||"",w),o.value.onclick=g,o.value.onshow=a,o.value.onerror=m,o.value.onclose=$,o.value},C=()=>{o.value&&o.value.close(),o.value=null};if(r&&se(f),G(C),s.value&&t){const u=t.document;ce(u,"visibilitychange",w=>{w.preventDefault(),u.visibilityState==="visible"&&C()})}return{isSupported:s,notification:o,ensurePermissions:f,permissionGranted:i,show:z,close:C,onClick:p,onShow:h,onError:l,onClose:T}}const fe={height:"523.213px",version:"1.1",viewBox:"0 0 289 523.213",width:"289px",x:"0px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",y:"0px"},me={__name:"digitNumber",props:["data","color"],setup(e){return W(t=>({ac1c3be2:e.color})),(t,r)=>(b(),A("svg",fe,[c("path",{id:"B",class:d({active:"045689".includes(e.data)}),d:"M20,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),c("path",{id:"C",class:d({active:"01234789".includes(e.data)}),d:"M289,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),c("path",{id:"A",class:d({active:"02356789".includes(e.data)}),d:"M255.082,1.873c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,20c-5.522-0.048-9.961-4.563-9.914-10.086l0,0C27.052,4.392,31.567-0.047,37.09,0L255.082,1.873z"},null,2),c("path",{id:"D",class:d({active:"2345689".includes(e.data)}),d:"M255.082,250.81c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914l-217.992-1.873c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,250.81z"},null,2),c("path",{id:"G",class:d({active:"0235689".includes(e.data)}),d:"M255.082,503.213c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,521.34c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,503.213z"},null,2),c("path",{id:"E",class:d({active:"0268".includes(e.data)}),d:"M20,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),c("path",{id:"F",class:d({active:"013456789".includes(e.data)}),d:"M289,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),c("circle",{class:d({active:e.data===":"}),cx:"146",cy:"126.873",r:"17"},null,2),c("circle",{class:d({active:e.data===":"}),cx:"146",cy:"389.818",r:"17"},null,2)]))}},ve=F(me,[["__scopeId","data-v-209fafe3"]]),pe=_("time",()=>{const e="1500",r=I(e),n=I(!1);return{timeLeft:r,isBreakTime:n,TIME:e,TIME_BREAK:"300"}},{persist:{key:"pomodoro-time",pick:[["timeleft","isBreakTime"]]}}),we={__name:"homeView",setup(e){const t=X(),r=Y(),n=pe(),s=L(()=>{const a=Math.floor(n.timeLeft/60).toString().padStart(2,"0"),l=(n.timeLeft%60).toString().padStart(2,"0");return a+":"+l}),i={STOP:0,COUNTING:1,PAUSE:2},o=I(i.STOP);let f=0;const p=()=>{o.value===i.STOP&&t.items.length>0&&t.currentItem===""&&(t.currentItem=n.isBreakTime?"休息":t.items.shift().text),o.value=i.COUNTING,f=setInterval(()=>{n.timeLeft--,n.timeLeft<0&&g()},1e3)},g=()=>{clearInterval(f),o.value=i.STOP;const a=new Audio;a.src=r.selectedAlarm.file,a.play();const{show:l,isSupported:m,permissionGranted:T}=de({title:"事項完成",body:t.currentItem,icon:new URL(""+new URL("pomodoro-technique-D_3Crlex.png",import.meta.url).href,import.meta.url).href});m.value&&T.value&&l(),n.isBreakTime||t.finishedItems.push({id:t.id++,text:t.currentItem}),t.currentItem="",t.items.length>0&&(n.isBreakTime=!n.isBreakTime),n.timeLeft=n.isBreakTime?n.TIME_BREAK:n.TIME,t.items.length>0&&p()},h=()=>{clearInterval(f),o.value=i.PAUSE};return(a,l)=>(b(),M(Q,null,{default:y(()=>[v(Z,null,{default:y(()=>[v(B,{cols:"12"},{default:y(()=>[...l[0]||(l[0]=[c("h1",{class:"text-center"},"目前事項",-1)])]),_:1}),v(ee),v(B,{class:"text-center",cols:"12"},{default:y(()=>[(b(!0),A(K,null,H(s.value,(m,T)=>(b(),M(ve,{key:T,color:"red",data:m},null,8,["data"]))),128)),c("h2",null,J(S(t).currentItem||"沒有事項"),1),v(N,{disabled:o.value===i.COUNTING||S(t).currentItem.length===0&&S(t).items.length===0,icon:"mdi-play",onClick:p},null,8,["disabled"]),v(N,{disabled:o.value!==i.COUNTING,icon:"mdi-pause",onClick:h},null,8,["disabled"]),v(N,{disabled:S(t).currentItem.length===0,icon:"mdi-skip-next",onClick:g},null,8,["disabled"])]),_:1})]),_:1})]),_:1}))}};export{we as default};
